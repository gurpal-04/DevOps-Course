<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Flask Assignment 2 - Form</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 40px;
      }
      form {
        max-width: 480px;
      }
      label {
        display: block;
        margin-top: 10px;
      }
      input,
      textarea {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
      }
      button {
        margin-top: 12px;
        padding: 8px 16px;
      }
      #result {
        margin-top: 20px;
        white-space: pre-wrap;
        background: #f7f7f7;
        padding: 12px;
      }
    </style>
  </head>
  <body>
    <h1>Contact Form (sends to Flask backend)</h1>
    <form id="theForm">
      <label for="name">Name</label>
      <input name="name" id="name" required />

      <label for="email">Email</label>
      <input name="email" id="email" type="email" required />

      <label for="message">Message</label>
      <textarea name="message" id="message" rows="5"></textarea>

      <button type="submit">Send</button>
    </form>

    <div id="result"></div>

    <script>
      const form = document.getElementById("theForm");
      const resultDiv = document.getElementById("result");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        resultDiv.textContent = "Sending...";

        const formData = new FormData(form);
        const data = new URLSearchParams();
        for (const pair of formData) data.append(pair[0], pair[1]);

        // send to our express endpoint which proxies to backend (or call backend directly)
        try {
          const res = await fetch("/submit", { method: "POST", body: data });
          const json = await res.json();
          resultDiv.textContent = JSON.stringify(json, null, 2);
        } catch (err) {
          resultDiv.textContent = "Error: " + err.message;
        }
      });
    </script>
  </body>
</html>
